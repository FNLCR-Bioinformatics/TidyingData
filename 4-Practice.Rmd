---
title: "Data Tidying: Practice"
output: github_document
---

### Cleaning up
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(knitr)
library(lubridate)
```

 
For the remainder of our time, you may continue to work on this example data set or begin working with your own data. If you would like to continue with this example, open the a copy of this Rmd file and edit it. Include all of your answers in the Rmd file, as well as any other code and relevant discussion. We will stick around for awhile to answer any questions you might have.

# Hands-on exercise using Wisconsin Breast Cancer dataset

Now, we will read a slightly complicated Breast Cancer dataset. You may use the import data set drop-down option to read the data in, but be sure to save the code generated by the dialog and record it in the code chunk below. 

![](Images/RS-ImportDataset.png)
![](Images/RS-ImportDataset1.png)

```{r readdata, include = FALSE}
# Modify the chunk statement such that no output is shown for this chunk

# import the data set here
wdbc <- read_csv("Data/wdbc.data", col_names = FALSE)

# Add column names:
cnames <- c("ID", "Diagnosis", 
            "radius", "Texture", "Perimeter", "area",
            "smoothness", "compactness", "concavity", "concave_points",
            "symmetry","fractaldim",
            "radiusSE", "TextureSE", "PerimeterSE", "areaSE",
            "smoothnessSE", "compactnessSE", "concavitySE", "concave_pointsSE",
            "symmetrySE","fractaldimSE",
            "radiusW", "TextureW", "PerimeterW", "areaW",
            "smoothnessW", "compactnessW", "concavityW", "concave_pointsW",
            "symmetryW","fractaldimW")

# add column names here
names(wdbc) <- cnames
```

The `wdbc` data set has `r nrow(wdbc)` samples and `r ncol(wdbc)` covariates. There are mean, standard error and worst observations for the following measures (see the [wdbc.names](https://github.com/ravichas/TidyingData/blob/master/Data/wdbc.names) file for more details):

* Texture
* Perimeter
* area
* smoothness
* compactness
* concavity
* concave_points
* symmetry
* fractaldim

Figures showing the raw relationship between diagnosis (benign or metastatic) tumors and some of these measures follows:

```{r raw data, echo=FALSE}
# do not echo the code from this chunk, but do show the figures

# Diagnosis by radius
ggplot(wdbc, aes(Diagnosis, radius)) + 
    geom_jitter()

# Diagnosis by Texture
ggplot(wdbc, aes(Diagnosis, Texture, color = TextureSE)) + 
    geom_jitter()

# Diagnosis by Perimiter
ggplot(wdbc, aes(Diagnosis, Perimeter, color = PerimeterSE)) + 
    geom_jitter()

# Diagnosis by smoothness
ggplot(wdbc, aes(Diagnosis, smoothness, color = smoothnessSE)) + 
    geom_jitter()

# we didn't cover plotting with ggplot(), but feel free to add more figures if you would like
```

```{r summary for report, include = FALSE}
# run this chunk, but do not print any of it's output to the document

# number of individuals with benign tumors
nBenign <- filter(wdbc, Diagnosis == 'B') %>%
           nrow()

# number of individuals with metastatic tumors
nMetastatic <- filter(wdbc, Diagnosis == 'M') %>%
               nrow()

# individuals with PerimeterSE > 5
nPerimeterSE_gt5 <- filter(wdbc, PerimeterSE > 5) %>%
                    nrow()
pctPerimeterSE_gt5 <- nPerimeterSE_gt5 / nrow(wdbc) * 100
pctPerimeterSE_gt5_M <- (filter(wdbc, PerimeterSE > 5 & Diagnosis == 'M') %>%
                         nrow()) / nPerimeterSE_gt5 * 100


##### creation of summaryTable #####

# Create a subset of wdbc containing only individuals with Diagnosis == 'B'
# and keep only Texture, Perimeter, area, smoothness, compactness, concavity, 
#               concave_points, symmetry, and fractaldim
meanBenign <- filter(wdbc, Diagnosis == 'B') %>%
              select(Texture, Perimeter, area, smoothness, compactness,
                     concavity, concave_points, symmetry, fractaldim)

# Create a subset of wdbc containing only individuals with Diagnosis == 'B'
# and keep only Texture, Perimeter, area, smoothness, compactness, concavity, 
#               concave_points, symmetry, and fractaldim

meanMetast <- filter(wdbc, Diagnosis == 'M') %>%
              select(Texture, Perimeter, area, smoothness, compactness,
                     concavity, concave_points, symmetry, fractaldim)

# fill table in with mean values among individuals with benign/metastatic diagnosis
summaryTable <- tibble(measure = c('Texture', 'Perimeter', 'area', 'smoothness',
                                   'compactness', 'concavity', 'concave_points', 
                                   'symmetry', 'fractaldim'),
                       meanB = apply(meanBenign, 2, mean),
                       meanM = apply(meanMetast, 2, mean))
```

The perimter of the cells appears to be fairly consistent within most samples, but `r round(pctPerimeterSE_gt5, 1)`% of the samples had a standard error over 5. Of these, `r round(pctPerimeterSE_gt5_M, 1)`% were diagnosed as metastatic.


```{r table, echo = FALSE}
if(!exists('summaryTable'))
    summaryTable <- tibble(measure = c('Texture', 'Perimeter', 'area', 'smoothness',
                                   'compactness', 'concavity', 'concave_points', 
                                   'symmetry', 'fractaldim'),
                           meanB = 'incomplete',
                           meanM = 'incomplete')

kable(summaryTable, caption = "This table shows the summary statistics for each of the measures")
```